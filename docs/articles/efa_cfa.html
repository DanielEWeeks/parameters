<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Structural Models (EFA, CFA, SEM, ...) • parameters</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cosmo/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Structural Models (EFA, CFA, SEM, ...)">
<meta property="og:description" content="">
<meta property="og:image" content="/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">parameters</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li>
  <a href="../reference/index.html">Features</a>
</li>
<li>
  <a href="../articles/model_parameters.html">Parameters Description</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Parameters Engineering
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/bootstrapping.html">Bootstrapped parameters</a>
    </li>
    <li>
      <a href="../articles/standardization.html">Standardized parameters</a>
    </li>
  </ul>
</li>
<li>
  <a href="../articles/parameters_selection.html">Parameters Selection</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Dimension Reduction
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/parameters_reduction.html">Feature reduction (PCA, cMDS, ICA, ...)</a>
    </li>
    <li>
      <a href="../articles/efa_cfa.html">Structural models (EFA, CFA, SEM, ...)</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Structural Models (EFA, CFA, SEM, …)</h1>
            
      
      
      <div class="hidden name"><code>efa_cfa.Rmd</code></div>

    </div>

    
    
<div id="exploratory-factor-analysis-efa" class="section level2">
<h2 class="hasAnchor">
<a href="#exploratory-factor-analysis-efa" class="anchor"></a>Exploratory Factor Analysis (EFA)</h2>
<p>The difference between PCA and EFA can be quite hard to intuitively grasp as their output is very familiar. The idea is that PCA aims at extracting the most variance possible from all variables of the dataset, whereas EFA aims at creating consistent factors from the dataset without desperately trying to represent all the variables.</p>
<p>This is why PCA is popular for feature reduction, as it will try to best represent the variance contained in the original data, minimizing the loss of information. On the other hand, EFA is usually in the context of exploring the latent dimensions that might be hidden in the observed variables, without necessary striving at representing the whole dataset.</p>
<p>To illustrate EFA, let us use the <a href="ipip.ori.org">International Personality Item Pool</a> data available in the <a href="https://www.personality-project.org/r/html/bfi.html"><code>psych</code></a> package. It includes 25 personality self report items. We will explore a factor structure made of 5 latent variables.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(dplyr)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(psych)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(parameters)</a>
<a class="sourceLine" id="cb1-4" title="4"></a>
<a class="sourceLine" id="cb1-5" title="5">data &lt;-<span class="st"> </span>psych<span class="op">::</span>bfi[, <span class="dv">1</span><span class="op">:</span><span class="dv">25</span>]  <span class="co"># Select only the 25 first columns corresponding to the items</span></a>
<a class="sourceLine" id="cb1-6" title="6">data &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/stats/na.fail.html">na.omit</a></span>(data)  <span class="co"># remove missing values</span></a>
<a class="sourceLine" id="cb1-7" title="7"></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="co"># Fit an EFA</span></a>
<a class="sourceLine" id="cb1-9" title="9">efa &lt;-<span class="st"> </span>psych<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/psych/man/fa.html">fa</a></span>(data, <span class="dt">nfactors =</span> <span class="dv">5</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb1-10" title="10"><span class="st">  </span><span class="kw"><a href="../reference/model_parameters.html">model_parameters</a></span>(<span class="dt">sort =</span> <span class="ot">TRUE</span>, <span class="dt">threshold =</span> <span class="st">"max"</span>)</a>
<a class="sourceLine" id="cb1-11" title="11">efa</a></code></pre></div>
<pre><code>&gt; # Rotated loadings from Principal Component Analysis (oblimin-rotation)
&gt; 
&gt; Variable |  MR2 |   MR3 |   MR1 |   MR5 |   MR4 | Complexity | Uniqueness
&gt; -------------------------------------------------------------------------
&gt; N1       | 0.83 |       |       |       |       |       1.07 |       0.32
&gt; N2       | 0.78 |       |       |       |       |       1.03 |       0.39
&gt; N3       | 0.70 |       |       |       |       |       1.08 |       0.46
&gt; N5       | 0.48 |       |       |       |       |       2.00 |       0.65
&gt; N4       | 0.47 |       |       |       |       |       2.33 |       0.49
&gt; C2       |      |  0.67 |       |       |       |       1.18 |       0.55
&gt; C4       |      | -0.64 |       |       |       |       1.13 |       0.52
&gt; C3       |      |  0.57 |       |       |       |       1.10 |       0.68
&gt; C5       |      | -0.56 |       |       |       |       1.41 |       0.56
&gt; C1       |      |  0.55 |       |       |       |       1.20 |       0.65
&gt; E2       |      |       |  0.67 |       |       |       1.08 |       0.45
&gt; E4       |      |       | -0.59 |       |       |       1.52 |       0.46
&gt; E1       |      |       |  0.55 |       |       |       1.22 |       0.65
&gt; E5       |      |       | -0.42 |       |       |       2.68 |       0.59
&gt; E3       |      |       | -0.41 |       |       |       2.65 |       0.56
&gt; A3       |      |       |       |  0.68 |       |       1.06 |       0.46
&gt; A2       |      |       |       |  0.66 |       |       1.03 |       0.54
&gt; A5       |      |       |       |  0.54 |       |       1.48 |       0.53
&gt; A4       |      |       |       |  0.45 |       |       1.74 |       0.70
&gt; A1       |      |       |       | -0.44 |       |       1.88 |       0.80
&gt; O3       |      |       |       |       |  0.62 |       1.16 |       0.53
&gt; O5       |      |       |       |       | -0.54 |       1.21 |       0.70
&gt; O1       |      |       |       |       |  0.52 |       1.10 |       0.68
&gt; O2       |      |       |       |       | -0.47 |       1.68 |       0.73
&gt; O4       |      |       |       |       |  0.36 |       2.65 |       0.75
&gt; 
&gt; The 5 latent factors (oblimin rotation) accounted for 42.36% of the total variance of the original data (MR2 = 10.31%, MR3 = 8.39%, MR1 = 8.83%, MR5 = 8.29%, MR4 = 6.55%).</code></pre>
<p>As we can see, the 25 items nicely spread on the 5 latent factors which are, you guessed it, the famous <strong>big 5</strong>. Based on this model, we can now predict back the scores for each individual for these new variables:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span>(efa, <span class="dt">names =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"Neuroticism"</span>, <span class="st">"Conscientiousness"</span>, <span class="st">"Extraversion"</span>, <span class="st">"Agreeableness"</span>, <span class="st">"Opennness"</span>))</a></code></pre></div>
<pre><code>&gt;   Neuroticism Conscientiousness Extraversion Agreeableness Opennness
&gt; 1       -0.22            -1.327       -0.128        -0.855     -1.61
&gt; 2        0.16            -0.572       -0.466        -0.072     -0.17
&gt; 3        0.62            -0.043       -0.141        -0.552      0.23
&gt; 4       -0.12            -1.063       -0.058        -0.091     -1.06
&gt; 5       -0.17            -0.099       -0.460        -0.712     -0.66
&gt; 6        0.19             1.399       -1.092         0.389      0.62</code></pre>
</div>
<div id="how-many-factors-to-retain-in-factor-analysis-fa" class="section level1">
<h1 class="hasAnchor">
<a href="#how-many-factors-to-retain-in-factor-analysis-fa" class="anchor"></a>How many factors to retain in Factor Analysis (FA)</h1>
<p>When running a <strong>factor analysis (FA)</strong>, one often needs to specify <strong>how many components</strong> (or latent variables) to retain or to extract. This decision is often motivated or supported by some statistical indices and procedures aiming at finding the optimal number of factors.</p>
<p>Interestingly, a huge amount of methods exist to statistically adress this issue, giving sometimes very different results… Unfortunately, there is no consensus on <strong>which method to use</strong>, or which is the best.</p>
<div id="the-method-agreement-procedure" class="section level2">
<h2 class="hasAnchor">
<a href="#the-method-agreement-procedure" class="anchor"></a>The Method Agreement procedure</h2>
<p>The Method Agreement procedure, first implemented in the <a href="https://neuropsychology.github.io/psycho.R/2018/05/24/n_factors.html"><code>psycho</code></a> pacakge <span class="citation">(Makowski 2018)</span>, proposes to rely on the consensus of methods, rather than on one method in particular.</p>
<p>This procedure can be easily used via the <code><a href="../reference/n_factors.html">n_factors()</a></code> function, re-implemented and improved in the <a href="https://github.com/easystats/parameters"><strong>parameters</strong></a> package. One can provide a dataframe, and the function will run a large number of routines and reutrn the optimal number of factors based on the higher consensus.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">n &lt;-<span class="st"> </span><span class="kw"><a href="../reference/n_factors.html">n_factors</a></span>(data)</a>
<a class="sourceLine" id="cb5-2" title="2">n</a></code></pre></div>
<pre><code>&gt; # Method Agreement Procedure:
&gt; 
&gt; The choice of 6 dimensions is supported by 3 (15.79%) methods out of 19 (Optimal coordinates, Parallel analysis, Kaiser criterion).</code></pre>
<p>Interestingly, the smallest nubmer of factors that most methods suggest is 6… Which is consistent whith the newer models of personality (e.g., HEXACO).</p>
<p>More details, as well as a summary table can be obtained as follows:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(n)</a></code></pre></div>
<pre><code>&gt;    n_Factors              Method              Family
&gt; 1          1 Acceleration factor               Scree
&gt; 2          3                 CNG                 CNG
&gt; 3          4                beta Multiple_regression
&gt; 4          4    VSS complexity 1                 VSS
&gt; 5          5    VSS complexity 2                 VSS
&gt; 6          5       Velicer's MAP        Velicers_MAP
&gt; 7          6 Optimal coordinates               Scree
&gt; 8          6   Parallel analysis               Scree
&gt; 9          6    Kaiser criterion               Scree
&gt; 10         7                   t Multiple_regression
&gt; 11         7                   p Multiple_regression
&gt; 12         7                  R2            Scree_SE
&gt; 13         8            SE Scree            Scree_SE
&gt; 14         8                 BIC                 BIC
&gt; 15        11      BIC (adjusted)                 BIC
&gt; 16        22             Bentler             Bentler
&gt; 17        24            Bartlett             Barlett
&gt; 18        24            Anderson             Barlett
&gt; 19        24              Lawley             Barlett</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(n)</a></code></pre></div>
<pre><code>&gt;    n_Factors n_Methods
&gt; 1          1         1
&gt; 2          3         1
&gt; 3          4         2
&gt; 4          5         2
&gt; 5          6         3
&gt; 6          7         3
&gt; 7          8         2
&gt; 8         11         1
&gt; 9         22         1
&gt; 10        24         3</code></pre>
<p>A plot can also be obtained (the <code>see</code> package must be loaded):</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(see)</a>
<a class="sourceLine" id="cb11-2" title="2"></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(n) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="st">  </span><span class="kw">theme_modern</span>()</a></code></pre></div>
<p><img src="efa_cfa_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
</div>
<div id="confirmatory-factor-analysis-cfa" class="section level1">
<h1 class="hasAnchor">
<a href="#confirmatory-factor-analysis-cfa" class="anchor"></a>Confirmatory Factor Analysis (CFA)</h1>
<p>CFA bridges factor analysis with Structural Equation Modelling (SEM).</p>
<p>Show <code>data_partition</code>.</p>
<p>TO DO.</p>
</div>
<div id="references" class="section level1 unnumbered">
<h1 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h1>
<div id="refs" class="references">
<div id="ref-makowski2018psycho">
<p>Makowski, Dominique. 2018. “The Psycho Package: An Efficient and Publishing-Oriented Workflow for Psychological Science.” <em>Journal of Open Source Software</em> 3 (22): 470.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#exploratory-factor-analysis-efa">Exploratory Factor Analysis (EFA)</a></li>
      <li>
<a href="#how-many-factors-to-retain-in-factor-analysis-fa">How many factors to retain in Factor Analysis (FA)</a><ul class="nav nav-pills nav-stacked">
<li><a href="#the-method-agreement-procedure">The Method Agreement procedure</a></li>
      </ul>
</li>
      <li><a href="#confirmatory-factor-analysis-cfa">Confirmatory Factor Analysis (CFA)</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by <a href="https://dominiquemakowski.github.io/">Dominique Makowski</a>, <a href="https://github.com/strengejacke">Daniel Lüdecke</a>, <a href="https://github.com/mattansb">Mattan S. Ben-Shachar</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
